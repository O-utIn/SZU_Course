use mysql;

DROP TABLE IF EXISTS EMP;
CREATE TABLE IF NOT EXISTS EMP (
  EMPNO int NOT NULL,
  ENAME varchar(10) NOT NULL,
  JOB char(9) NOT NULL,
  MGR int DEFAULT NULL REFERENCES EMP(EMPNO),
  HIREDATE varchar(9) DEFAULT NULL,
  SAL float NOT NULL CHECK(SAL>5000),
  COMM float DEFAULT NULL,
  DEPTNO float(2) NOT NULL REFERENCES DEPT,
  PRIMARY KEY (EMPNO)
);

INSERT INTO EMP (EMPNO,ENAME,JOB,MGR,HIREDATE,SAL,COMM,DEPTNO) VALUES
(7369,'SMITH','CLERK',7902,'17-DEC-90',13750,NULL,20),  
(7499,'ALLEN','SALESMAN',7698,'20-FEB-89',19000,6400,30),  
(7521,'WARD','SALESMAN',7698,'22-FEB-93',18500,4250,30),  
(7566,'JONES','MANAGER',7839,'02-APR-89',26850,NULL,20),  
(7654,'MARTIN','SALESMAN',7698,'28-SEP-97',15675,3500,30),  
(7698,'BLAKE','MANAGER',7839,'01-MAY-90',24000,NULL,30),  
(7782,'CLARK','MANAGER',7839,'09-JUN-88',27500,NULL,10),  
(7788,'SCOTT','ANALYST',7566,'19-APR-87',19500,NULL,20),  
(7839,'KING','PRESIDENT',NULL,'17-NOV-83',82500,NULL,10),  
(7844,'TURNER','SALESMAN',7698,'08-SEP-92',18500,6250,30),  
(7876,'ADAMS','CLERK',7788,'23-MAY-96',11900,NULL,20),  
(7900,'JAMES','CLERK',7698,'03-DEC-95',12500,NULL,30),  
(7902,'FORD','ANALYST',7566,'03-DEC-91',21500,NULL,20),  
(7934,'MILLER','CLERK',7782,'23-JAN-95',13250,NULL,10),
(3258,'GREEN','SALESMAN',4422,'24-JUL-95',18500,2750,50),
(4422,'STEVENS','MANAGER',7839,'14-JAN-94',24750,NULL,50),
(6548,'BARNES','CLERK',4422,'16-JAN-95',11950,NULL,50),
(7500,'CAMPBELL','ANALYST',7566,'30-OCT-92',24500,0,40);

DROP TABLE IF EXISTS DEPT;
CREATE TABLE IF NOT EXISTS DEPT (
	DEPTNO INT NOT NULL,
    DNAME varchar(10),
    LOC varchar(10),
    PRIMARY KEY(DEPTNO)
);

INSERT INTO DEPT (DEPTNO,DNAME,LOC) VALUES
(10,'ACCOUNTING','LONDON'),
(30,'SALES','LIVERPOOL'),
(40,'OPERATIONS','STAFFORD'),
(50,'MARKETING','LUTON'),
(20,'RESEARCH','PRESTON');

show tables;
-- 1
select * from EMP;
-- 2
select * from DEPT;
-- 3
select ENAME from EMP;
select EMPNO from EMP;
select SAL from EMP;
select DEPTNO from EMP;
-- 4
select * from EMP WHERE DEPTNO = 10 OR DEPTNO = 30;
-- 5
select distinct JOB from EMP;
-- 6
select ENAME from EMP WHERE SAL<20000;
-- 7
select ENAME,JOB,EMPNO,SAL from EMP where DEPTNO=20 AND SAL>25000;
-- 8
select ENAME,JOB from EMP WHERE JOB='CLERK' OR JOB='SALESMAN';
-- 9
select ENAME,DEPTNO from EMP WHERE JOB='CLERK' AND DEPTNO!=10;
-- 10
select ENAME from EMP WHERE JOB='SALESMAN';
select ENAME,DEPTNO from EMP WHERE JOB='ANALYST' AND DEPTNO=20;
-- 11
select ENAME,DEPTNO,SAL from EMP where SAL>15000 AND SAL<20000;
-- 12
select ENAME,JOB from EMP where JOB='PRESIDENT';
-- 13
select ENAME from EMP where ENAME LIKE '%S';
-- 14
select ENAME from EMP where ENAME LIKE '%TH%' OR ENAME LIKE '%LL%';
-- 15
select ENAME from EMP where COMM>0;
-- 16
select ENAME,JOB,SAL,HIREDATE,DEPTNO from EMP ORDER BY LOWER(ENAME);
-- 17
select ENAME,JOB,SAL,HIREDATE,DEPTNO from EMP ORDER BY SAL ASC,ENAME ASC;
-- 18
select ENAME,COMM,SAL from EMP ORDER BY COMM/SAL DESC;
-- 19
select ENAME,COMM,DEPTNO from EMP WHERE COMM>0 AND DEPTNO=30 ORDER BY COMM ASC;
-- 20
select ENAME,JOB,SAL,COMM,MGR from EMP WHERE MGR IS NULL;
-- 21
select ENAME,JOB,SAL from EMP WHERE DEPTNO=30 AND SAL>=18000 AND JOB="SALESMAN";
-- 22
select EMPNO, ENAME, JOB, SAL, HIREDATE from EMP WHERE
CAST(CONCAT('19', SUBSTRING(HIREDATE, 9, 2)) AS UNSIGNED) < 1998 AND (SAL > 5000 OR SAL < 1000);
-- 23
-- ALTER TABLE EMP  
-- ADD CONSTRAINT PK_EMP PRIMARY KEY (EMPNO);
-- 24
ALTER TABLE EMP  
ADD EMP_family_name VARCHAR(255);
-- select * from EMP;
-- 25
-- ALTER TABLE EMP  
-- DROP CONSTRAINT PK_EMP;
-- 26
ALTER TABLE EMP RENAME TO EMPLOYEE;
select * from EMPLOYEE;
-- 27
ALTER TABLE EMPLOYEE RENAME TO EMP;
select * from EMP;
-- 28
ALTER TABLE EMP  
DROP COLUMN EMP_family_name;
select * from EMP;
-- 29
DROP TABLE IF EXISTS employee;
CREATE TABLE employee AS SELECT * FROM EMP;
select * from employee;
-- 30
DROP TABLE employee;
-- 31
select * from EMP WHERE COMM IS NULL;
